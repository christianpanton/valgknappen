<html>
  <head>
    <meta charset="UTF-8" />
    <script src="dk.api.stm.valg.UdskrivValgService.binding.min.js"></script>
    <link href="dk.api.stm.valg.UdskrivValgService.binding.min.css" rel="stylesheet">
  </head>
  <body>
    <div class="regeringOverMidten">

      <div class="tick" data-value="" data-did-init="setupFlip">
        <div data-repeat="true" aria-hidden="true">
          <span data-view="flip"></span>
        </div>
      </div>

      <button id="valg"><span>Valg!</span></button>
    </div>

    <script>
      var knap = document.getElementById("valg");
      var confetti = new JSConfetti();


      function valgtema()
      {

        if(globalTick.value % 1000 === 666)
          return ["ðŸ‘¿", "ðŸ˜ˆ", "ðŸ¤˜"];

        if(globalTick.value % 1000 === 420)
          return ["ðŸŒ¿", "ðŸ¥¦", "ðŸŒ³", "ðŸ", "ðŸƒ", "ðŸ€", "ðŸª´", "ðŸ”¥"];

        return ["ðŸ—³ï¸", "ðŸ—³ï¸", "ðŸ—³ï¸", "ðŸ¦ ", "ðŸ˜·", "ðŸª–", "ðŸ‡ºðŸ‡¦", "â›½", "ðŸ™ˆ", "ðŸ™‰", "ðŸ™Š", "ðŸŒ", "ðŸŒŠ", "ðŸ”¥"];
      }

      function setupFlip(tick) {
        globalTick = tick;
        fetch('/count').then(r => r.json()).then(j => tick.value = j["count"]);
      }

      function udskrivValget() {
        knap.classList.add("pressed");
        knap.removeEventListener("click", udskrivValget);

        confetti.addConfetti({
          emojis: valgtema()
        });

        setTimeout(function() {
            UdskrivValgServiceType_UdskrivValg();
            knap.classList.remove("pressed");
            knap.addEventListener("click", udskrivValget);
            globalTick.value++;
        }, 1500);
      }

      knap.addEventListener("click", udskrivValget);
    </script>
  </body>
</html>
